function create_user(){for(var e=new FormData,a=document.getElementById("create-user-form").children,t=0;t<a.length;t++)"text"==a[t].type||"password"==a[t].type?e.append(a[t].name,a[t].value):"file"==a[t].type&&e.append(a[t].name,a[t].files[0],a[t].files[0].name);$.ajax({method:"POST",url:"/create/new_user",data:e,processData:!1,contentType:!1,success:function(){console.log("Back!")}})}
var ClickGame={init:function(){gameObject.laserWidth=10,gameObject.container=document.getElementById("game-container"),gameObject.position=gameObject.container.getBoundingClientRect(),gameObject.screenHeight=gameObject.position.bottom,gameObject.screenWidth=gameObject.position.width,gameObject.containerHeight=gameObject.position.height-gameObject.position.top-gameObject.laserWidth/2,gameObject.containerWidth=gameObject.position.width-gameObject.laserWidth/2,userControlled.cannons={topRight:{obj:null,side:"right",position:null,centerPoint:[0,0]},bottomRight:{obj:null,side:"right",position:null,centerPoint:[0,0]},topLeft:{obj:null,"side:":"left",position:null,centerPoint:[0,0]},bottomLeft:{obj:null,"side:":"left",position:null,centerPoint:[0,0]}},gameObject.mouseX,gameObject.mouseY,gameObject.currentCannon="topLeft";for(var e in userControlled.cannons){userControlled.cannons[e].side;userControlled.cannons[e].obj=document.createElement("div"),userControlled.cannons[e].obj.setAttribute("id","cannon-"+e),userControlled.cannons[e].obj.setAttribute("class","cannon-general"),gameObject.container.appendChild(userControlled.cannons[e].obj),userControlled.cannons[e].position=userControlled.cannons[e].obj.getBoundingClientRect(),userControlled.cannons[e].position.height/2}for(var e in userControlled.cannons)userControlled.cannons[e].centerPoint[1]=gameObject.screenHeight-(userControlled.cannons[e].position.bottom-userControlled.cannons[e].position.height/2),userControlled.cannons[e].centerPoint[0]=userControlled.cannons[e].position.left-gameObject.position.left;gameObject.cannonHeight=document.getElementById("cannon-"+gameObject.currentCannon).clientHeight,gameObject.laserArray=[],gameObject.laserCounter=0,gameObject.laserTimers=[],gameObject.fighterCounter=0,gameObject.fighterTimers=[],gameObject.fighters=[],gameObject.container.addEventListener("click",ClickGame.laserInit),document.addEventListener("keyup",ClickGame.keypress),document.onmousemove=function(e){var t=ClickGame.getAngle(e,!0);userControlled.cannons[gameObject.currentCannon].obj.style.webkitTransform="translateY(-50%) rotate( "+t+"deg)",userControlled.cannons[gameObject.currentCannon].obj.style.transform="translateY(-50%) rotate( "+t+"deg)"},ClickGame.FighterInit()},laserInit:function(e){var t={slope:0,yIntercept:0,xIncrementor:0,laserNum:-1,obj:null,side:"left"};document.getElementById("tie-fighter-audio");t.side=userControlled.cannons[gameObject.currentCannon].side;var n=userControlled.cannons[gameObject.currentCannon].obj.clientHeight,r="right"!=t.side?0:gameObject.position.width,o=(gameObject.screenHeight,userControlled.cannons[gameObject.currentCannon].position.bottom,e.clientX-gameObject.position.left),a=Math.abs(e.clientY-gameObject.screenHeight);t.obj=ClickGame.createLaser(e,r),t.slope=ClickGame.getSlope(o,a),t.xIncrementor=gameObject.laserWidth,t.yIntercept=parseInt(t.obj.style.bottom.replace("px","")),t.laserNum=gameObject.laserCounter,ClickGame.updateLaser(t,0),gameObject.laserCounter+=1},createLaser:function(e,t){var n=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),a=ClickGame.getAngle(e,!1),c=userControlled.cannons[gameObject.currentCannon].side;r.className="laser-top laser-general",o.className="laser-bottom laser-general",n.appendChild(r),n.appendChild(o),o.className="right"!==c?(n.className="laser-container laser-container-left push-laser-left laserNum-"+gameObject.laserCounter,r.className="laser-top push-laser-right laser-general","laser-bottom push-laser-right laser-general"):(n.className="laser-container laser-container-right push-laser-right laserNum-"+gameObject.laserCounter,r.className="laser-top push-laser-left laser-general","laser-bottom push-laser-left laser-general"),"right"!=c?n.style.left="0px":n.style.right="0px",n.style.transform="translateY(-50%) rotate( "+a+"deg)",n.style.webkitTransform="translateY(-50%) rotate( "+a+"deg)";var i=userControlled.cannons[gameObject.currentCannon].position.height/2,s=gameObject.screenHeight-(userControlled.cannons[gameObject.currentCannon].position.bottom+i);return n.style.bottom=s+"px",gameObject.container.appendChild(n),n},updateLaser:function(a,c){gameObject.laserTimers[a.laserNum]=setTimeout(function(){var e=a.side,t=c+a.xIncrementor,n=a.slope*t,r=(n="right"!=e?n:-n)+a.yIntercept;a.obj.style.bottom=r+"px","right"!=e?a.obj.style.left=t+"px":a.obj.style.right=t+"px";var o=ClickGame.hasHit(a.obj);0<=t&&t<gameObject.containerWidth&&0<=r&&r<gameObject.containerHeight&&!o?ClickGame.updateLaser(a,t):(a.obj.remove(),clearTimeout(gameObject.laserTimers[a.laserNum]))},5)},FighterInit:function(){for(var e=[],t=!1,n=5<Math.ceil(10*Math.random())?0:2,r=0;r<3;r++){var o=ClickGame.createFighters(3,r);r%2!=0||t||r!=n||(t=o.isAttacker=!0),gameObject.fighters.push(o),e.push(o),gameObject.fighterCounter++}[].forEach.call(e,function(e){ClickGame.updateFighter(e)}),setTimeout(function(){ClickGame.FighterInit()},1e4)},createFighters:function(e,t){var n={y:0,yIncrementor:10,x:0,xIncrementor:10,totalHP:3,hitPoints:3,fighterNum:gameObject.fighterCounter,hpBar:null,container:null,obj:null,position:-1,isAttacker:!1};if(n.obj=document.createElement("div"),n.hpBar=document.createElement("div"),n.container=document.createElement("div"),n.hpBar.className="fighter-hit-points",n.hpBar.style.width="30px",n.obj.className="fighters fighter+"+gameObject.fighterCounter+"+",n.container.appendChild(n.obj),n.container.appendChild(n.hpBar),n.container.className="fighter-containers",n.position=t,n.isAttacker=!1,2==e)switch(t){case 0:n.x=gameObject.screenWidth/2-15-30,n.y=-60;break;case 1:n.x=gameObject.screenWidth/2-15+30,n.y=-60}else switch(t){case 0:n.x=gameObject.screenWidth/2-15-55,n.y=-70;break;case 1:n.x=gameObject.screenWidth/2-15,n.y=-60;break;case 2:n.x=gameObject.screenWidth/2-15+55,n.y=-70}return n.container.style.left=n.x+"px",n.container.style.top=n.y+"px",gameObject.container.appendChild(n.container),n},updateFighter:function(t,e){gameObject.fighterTimers[t.fighterNum]=setTimeout(function(){t.y+=t.yIncrementor,t.container.style.top=t.y+"px";t.obj.className.match(/\+(.*)\+/)[1];var e=5<Math.ceil(10*Math.random())?"top":"bottom";t.isAttacker&&(0==t.position?(e+"left",console.log("turret left"),t.x=t.x-1):(e+"right",console.log("turret right"),t.x+=1),t.container.style.left=t.x+"px"),t.y<=gameObject.screenHeight?ClickGame.updateFighter(t):(clearTimeout(gameObject.fighterTimers[t.figherNum]),t.container.remove())},100)},getAngle:function(e){var t=userControlled.cannons[gameObject.currentCannon].side,n=userControlled.cannons[gameObject.currentCannon].position,r=e.clientX-gameObject.position.left,o=Math.abs(e.clientY-gameObject.screenHeight),a=gameObject.screenHeight-(n.bottom-gameObject.cannonHeight/2),c=("right"==t?n.right:n.left,"right"==t?gameObject.screenWidth:0),i=o,s=r,l=o,m=a,g=Math.abs(s-c)/Math.abs(m-i),u=180*Math.atan(g)/Math.PI;return u=90-u,"right"==t?l<m&&(u=-u):m<l&&(u=-u),u},hasHit:function(c){var e=document.getElementsByClassName("fighters"),i=!1;return[].forEach.call(e,function(e){var t=e.getBoundingClientRect(),n=c.getBoundingClientRect(),r=e.className.match(/\+(.*)\+/)[1],o=gameObject.fighters[r];if((n.top>t.top&&n.top<t.bottom||n.bottom>t.top&&n.bottom<t.bottom)&&(n.right<t.right&&n.right>t.left||n.left<t.right&&n.left>t.left)){o.hitPoints=o.hitPoints-1;var a=o.hpBar.style.width.replace("px","")*(o.hitPoints/o.totalHP);o.hpBar.style.width=a+"px",0==o.hitPoints&&e.parentNode.remove(),i=!0}}),i},keypress:function(e){switch(e.keyCode){case 49:gameObject.currentCannon="topLeft";break;case 50:gameObject.currentCannon="bottomLeft";break;case 51:gameObject.currentCannon="topRight";break;case 52:gameObject.currentCannon="bottomRight"}},getSlope:function(e,t){return(t-userControlled.cannons[gameObject.currentCannon].centerPoint[1])/(e-userControlled.cannons[gameObject.currentCannon].centerPoint[0])},lineLength:function(e,t){var n=Math.pow(userControlled.cannons[gameObject.currentCannon].centerPoint[0]-e,2),r=Math.pow(userControlled.cannons[gameObject.currentCannon].centerPoint[0]-t,2);return Math.sqrt(n+r)}},gameObject=new Object,userControlled=new Object;window.onload=ClickGame.init();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFqYXguanMiLCJtYWluLmpzIl0sIm5hbWVzIjpbImNyZWF0ZV91c2VyIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInRoZV9mb3JtIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNoaWxkcmVuIiwiaSIsImxlbmd0aCIsInR5cGUiLCJhcHBlbmQiLCJuYW1lIiwidmFsdWUiLCJmaWxlcyIsIiQiLCJhamF4IiwibWV0aG9kIiwidXJsIiwiZGF0YSIsInByb2Nlc3NEYXRhIiwiY29udGVudFR5cGUiLCJzdWNjZXNzIiwiY29uc29sZSIsImxvZyIsIkNsaWNrR2FtZSIsImluaXQiLCJnYW1lT2JqZWN0IiwibGFzZXJXaWR0aCIsImNvbnRhaW5lciIsInBvc2l0aW9uIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0Iiwic2NyZWVuSGVpZ2h0IiwiYm90dG9tIiwic2NyZWVuV2lkdGgiLCJ3aWR0aCIsImNvbnRhaW5lckhlaWdodCIsImhlaWdodCIsInRvcCIsImNvbnRhaW5lcldpZHRoIiwidXNlckNvbnRyb2xsZWQiLCJjYW5ub25zIiwidG9wUmlnaHQiLCJvYmoiLCJzaWRlIiwiY2VudGVyUG9pbnQiLCJib3R0b21SaWdodCIsInRvcExlZnQiLCJzaWRlOiIsImJvdHRvbUxlZnQiLCJtb3VzZVgiLCJtb3VzZVkiLCJjdXJyZW50Q2Fubm9uIiwiaiIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImxlZnQiLCJjYW5ub25IZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJsYXNlckFycmF5IiwibGFzZXJDb3VudGVyIiwibGFzZXJUaW1lcnMiLCJmaWdodGVyQ291bnRlciIsImZpZ2h0ZXJUaW1lcnMiLCJmaWdodGVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJsYXNlckluaXQiLCJrZXlwcmVzcyIsIm9ubW91c2Vtb3ZlIiwiZXZlbnQiLCJkZWdyZWUiLCJnZXRBbmdsZSIsInN0eWxlIiwid2Via2l0VHJhbnNmb3JtIiwidHJhbnNmb3JtIiwiRmlnaHRlckluaXQiLCJsYXNlclZhbHVlcyIsInNsb3BlIiwieUludGVyY2VwdCIsInhJbmNyZW1lbnRvciIsImxhc2VyTnVtIiwieCIsImNsaWVudFgiLCJNYXRoIiwiYWJzIiwiY2xpZW50WSIsImNyZWF0ZUxhc2VyIiwiZ2V0U2xvcGUiLCJwYXJzZUludCIsInJlcGxhY2UiLCJ1cGRhdGVMYXNlciIsImxhc2VyIiwibGFzZXJUb3AiLCJsYXNlckJvdHRvbSIsImNsYXNzTmFtZSIsInJpZ2h0Iiwic2V0VGltZW91dCIsIm5ld1giLCJteCIsIm5ld1kiLCJoaXRCb3giLCJoYXNIaXQiLCJyZW1vdmUiLCJjbGVhclRpbWVvdXQiLCJjdXJyZW50RmlnaHRlcnMiLCJhdHRhY2tlclNldCIsInJhbmRvbU51bWJlciIsImNlaWwiLCJyYW5kb20iLCJmaWdodGVyIiwiY3JlYXRlRmlnaHRlcnMiLCJpc0F0dGFja2VyIiwicHVzaCIsImZvckVhY2giLCJjYWxsIiwidXBkYXRlRmlnaHRlciIsIm51bUZpZ2h0ZXJzIiwibnVtYmVyIiwieSIsInlJbmNyZW1lbnRvciIsInRvdGFsSFAiLCJoaXRQb2ludHMiLCJmaWdodGVyTnVtIiwiaHBCYXIiLCJjaG9zZW5GaWdodGVyIiwibWF0Y2giLCJ0b3BPckJvdHRvbVR1cnJldCIsImZpZ2hlck51bSIsImNhbm5vblkiLCJ3YWxsIiwibW91c2UiLCJjYW5ub24iLCJ0YW4iLCJhdGFuIiwiUEkiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiaGl0IiwidGhlTGFzZXIiLCJjdXJyZW50RmlnaHRlciIsIm5ld0hQIiwicGFyZW50Tm9kZSIsImtleUNvZGUiLCJYMSIsIlkxIiwibGluZUxlbmd0aCIsIlgiLCJZIiwieENhbGMiLCJwb3ciLCJ5Q2FsYyIsInNxcnQiLCJPYmplY3QiLCJ3aW5kb3ciLCJvbmxvYWQiXSwibWFwcGluZ3MiOiJBQUNBLFNBQVNBLGNBS1IsSUFKQSxJQUFJQyxFQUFXLElBQUlDLFNBRWZDLEVBQVdDLFNBQVNDLGVBQWdCLG9CQUFxQkMs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QUFVLFNBQVNFLEdBQ2xCLE9BQU9BLEVBQU13RSxTQUNaLEtBQUssR0FDSm5ILFdBQVd5QixjQUFnQixVQUMzQixNQUNELEtBQUssR0FDSnpCLFdBQVd5QixjQUFnQixhQUMzQixNQUNELEtBQUssR0FDSnpCLFdBQVd5QixjQUFnQixXQUMzQixNQUNELEtBQUssR0FDSnpCLFdBQVd5QixjQUFnQixnQkFNOUJvQyxTQUFVLFNBQVV1RCxFQUFJQyxHQUN2QixPQUFTQSxFQUFLeEcsZUFBZUMsUUFBUWQsV0FBV3lCLGVBQWVQLFlBQVksS0FBU2tHLEVBQUt2RyxlQUFlQyxRQUFRZCxXQUFXeUIsZUFBZVAsWUFBWSxLQUl2Sm9HLFdBQVksU0FBV0MsRUFBR0MsR0FDekIsSUFDSUMsRUFBUWhFLEtBQUtpRSxJQUFPN0csZUFBZUMsUUFBUWQsV0FBV3lCLGVBQWVQLFlBQVksR0FBS3FHLEVBQU0sR0FDNUZJLEVBQVFsRSxLQUFLaUUsSUFBTzdHLGVBQWVDLFFBQVFkLFdBQVd5QixlQUFlUCxZQUFZLEdBQUtzRyxFQUFLLEdBRS9GLE9BQU8vRCxLQUFLbUUsS0FBT0gsRUFBUUUsS0FNekIzSCxXQUFhLElBQUk2SCxPQUNqQmhILGVBQWlCLElBQUlnSCxPQUN6QkMsT0FBT0MsT0FBU2pJLFVBQVVDIiwiZmlsZSI6ImFsbGpzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuZnVuY3Rpb24gY3JlYXRlX3VzZXIoKSB7IFxuXHR2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcblxuXHR2YXIgdGhlX2Zvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggXCJjcmVhdGUtdXNlci1mb3JtXCIgKS5jaGlsZHJlbjtcblxuXHRmb3IoIHZhciBpID0gMDsgaSA8IHRoZV9mb3JtLmxlbmd0aDsgaSsrICkge1xuXG5cdFx0aWYgKCAndGV4dCcgPT0gdGhlX2Zvcm1baV0udHlwZSB8fCAncGFzc3dvcmQnID09IHRoZV9mb3JtW2ldLnR5cGUgKSB7XG5cdFx0XHRmb3JtRGF0YS5hcHBlbmQoIHRoZV9mb3JtW2ldLm5hbWUsIHRoZV9mb3JtW2ldLnZhbHVlICk7XG5cdFx0fSBlbHNlIGlmICggJ2ZpbGUnID09IHRoZV9mb3JtW2ldLnR5cGUgKSB7XG5cdFx0XHRmb3JtRGF0YS5hcHBlbmQoIHRoZV9mb3JtW2ldLm5hbWUsIHRoZV9mb3JtW2ldLmZpbGVzWzBdLCB0aGVfZm9ybVtpXS5maWxlc1swXS5uYW1lKTsgXG5cdFx0fVxuXHR9XG5cblx0JC5hamF4KCB7XG5cdFx0bWV0aG9kXHQ6ICdQT1NUJyxcblx0XHR1cmxcdFx0OiAnL2NyZWF0ZS9uZXdfdXNlcicsXG5cdFx0ZGF0YSBcdDogZm9ybURhdGEsXG5cdFx0cHJvY2Vzc0RhdGE6IGZhbHNlLCAgXG5cdCAgICBjb250ZW50VHlwZTogZmFsc2UsXG5cdFx0c3VjY2VzcyA6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Y29uc29sZS5sb2coJ0JhY2shJyk7XG5cdFx0fVxuXHR9KTtcbn0iLCJ2YXIgQ2xpY2tHYW1lID0ge1xuXHQvLyBTZXR0aW5nIHVwIGdhbWVPYmplY3QgdmFyaWFibGVzXG5cdGluaXQ6IGZ1bmN0aW9uICgpIHsgXG5cdFx0XHRnYW1lT2JqZWN0Lmxhc2VyV2lkdGggXHRcdD0gMTA7XG5cdFx0XHRnYW1lT2JqZWN0LmNvbnRhaW5lciBcdFx0PSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZS1jb250YWluZXInKTtcblx0XHRcdGdhbWVPYmplY3QucG9zaXRpb24gXHRcdD0gZ2FtZU9iamVjdC5jb250YWluZXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cdFx0XHRnYW1lT2JqZWN0LnNjcmVlbkhlaWdodCBcdD0gZ2FtZU9iamVjdC5wb3NpdGlvbi5ib3R0b207XG5cdFx0XHRnYW1lT2JqZWN0LnNjcmVlbldpZHRoIFx0XHQ9IGdhbWVPYmplY3QucG9zaXRpb24ud2lkdGg7XG5cdFx0XHRnYW1lT2JqZWN0LmNvbnRhaW5lckhlaWdodCBcdD0gKGdhbWVPYmplY3QucG9zaXRpb24uaGVpZ2h0IC0gZ2FtZU9iamVjdC5wb3NpdGlvbi50b3ApIC0gKGdhbWVPYmplY3QubGFzZXJXaWR0aC8yKTtcblx0XHRcdGdhbWVPYmplY3QuY29udGFpbmVyV2lkdGggXHQ9IGdhbWVPYmplY3QucG9zaXRpb24ud2lkdGggLSAoZ2FtZU9iamVjdC5sYXNlcldpZHRoLzIpO1xuXHRcdFx0dXNlckNvbnRyb2xsZWQuY2Fubm9ucyBcdFx0PSB7XG5cdFx0XHRcdCd0b3BSaWdodCcgOiB7ICdvYmonIDogbnVsbCwgJ3NpZGUnOiAncmlnaHQnLCAncG9zaXRpb24nOiBudWxsLCAnY2VudGVyUG9pbnQnOiBbMCwwXX0sXG5cdFx0XHRcdCdib3R0b21SaWdodCcgOiB7ICdvYmonIDogbnVsbCwgJ3NpZGUnOiAncmlnaHQnLCAncG9zaXRpb24nOiBudWxsLCAnY2VudGVyUG9pbnQnOiBbMCwwXX0sXG5cdFx0XHRcdCd0b3BMZWZ0JyA6IHsgJ29iaicgOiBudWxsLCAnc2lkZTonOiAnbGVmdCcsICdwb3NpdGlvbic6IG51bGwsICdjZW50ZXJQb2ludCc6IFswLDBdfSxcblx0XHRcdFx0J2JvdHRvbUxlZnQnIDogeyAnb2JqJyA6IG51bGwsICdzaWRlOic6ICdsZWZ0JywgJ3Bvc2l0aW9uJzogbnVsbCwgJ2NlbnRlclBvaW50JzogWzAsMF19XG5cdFx0XHR9O1xuXHRcdFx0Z2FtZU9iamVjdC5tb3VzZVg7XG5cdFx0XHRnYW1lT2JqZWN0Lm1vdXNlWTtcblx0XHRcdGdhbWVPYmplY3QuY3VycmVudENhbm5vbiA9ICd0b3BMZWZ0JzsgIFxuXG5cdFx0XHR2YXIgaGVpZ2h0IFx0PSAwO1xuXG5cdFx0XHRmb3IoIHZhciBqIGluIHVzZXJDb250cm9sbGVkLmNhbm5vbnMgKSB7XG5cdFx0XHRcdHZhciBzaWRlID0gdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tqXS5zaWRlO1xuXHRcdFx0XHR1c2VyQ29udHJvbGxlZC5jYW5ub25zW2pdLm9iaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdFx0XHR1c2VyQ29udHJvbGxlZC5jYW5ub25zW2pdLm9iai5zZXRBdHRyaWJ1dGUoICdpZCcsICdjYW5ub24tJyArIGogKTtcblx0XHRcdFx0dXNlckNvbnRyb2xsZWQuY2Fubm9uc1tqXS5vYmouc2V0QXR0cmlidXRlKCAnY2xhc3MnLCAnY2Fubm9uLWdlbmVyYWwnICk7XG5cdFx0XHRcdGdhbWVPYmplY3QuY29udGFpbmVyLmFwcGVuZENoaWxkKHVzZXJDb250cm9sbGVkLmNhbm5vbnNbal0ub2JqKTtcblx0XHRcdFx0dXNlckNvbnRyb2xsZWQuY2Fubm9uc1tqXS5wb3NpdGlvbiA9IHVzZXJDb250cm9sbGVkLmNhbm5vbnNbal0ub2JqLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0XHRoZWlnaHQgPSB1c2VyQ29udHJvbGxlZC5jYW5ub25zW2pdLnBvc2l0aW9uLmhlaWdodC8yO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IoIHZhciBqIGluIHVzZXJDb250cm9sbGVkLmNhbm5vbnMgKSB7XG5cdFx0XHRcdHVzZXJDb250cm9sbGVkLmNhbm5vbnNbal0uY2VudGVyUG9pbnRbMV0gPSBnYW1lT2JqZWN0LnNjcmVlbkhlaWdodCAtICggdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tqXS5wb3NpdGlvbi5ib3R0b20gLSAodXNlckNvbnRyb2xsZWQuY2Fubm9uc1tqXS5wb3NpdGlvbi5oZWlnaHQgLyAyKSApO1xuXHRcdFx0XHR1c2VyQ29udHJvbGxlZC5jYW5ub25zW2pdLmNlbnRlclBvaW50WzBdID0gdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tqXS5wb3NpdGlvbi5sZWZ0IC0gZ2FtZU9iamVjdC5wb3NpdGlvbi5sZWZ0O1xuXHRcdFx0fVxuXG5cblx0XHRcdGdhbWVPYmplY3QuY2Fubm9uSGVpZ2h0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nhbm5vbi0nICsgZ2FtZU9iamVjdC5jdXJyZW50Q2Fubm9uKS5jbGllbnRIZWlnaHQ7XG5cblx0XHRcdGdhbWVPYmplY3QubGFzZXJBcnJheSA9IFtdO1xuXHRcdFx0Z2FtZU9iamVjdC5sYXNlckNvdW50ZXIgPSAwO1xuXHRcdFx0Z2FtZU9iamVjdC5sYXNlclRpbWVycyA9IFtdO1xuXHRcdFx0Z2FtZU9iamVjdC5maWdodGVyQ291bnRlciA9IDA7XG5cdFx0XHRnYW1lT2JqZWN0LmZpZ2h0ZXJUaW1lcnMgPSBbXTtcblx0XHRcdGdhbWVPYmplY3QuZmlnaHRlcnMgPSBbXTtcblxuXHRcdFx0Z2FtZU9iamVjdC5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBDbGlja0dhbWUubGFzZXJJbml0KTtcblx0XHRcdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgQ2xpY2tHYW1lLmtleXByZXNzKTtcblxuXHRcdFx0ZG9jdW1lbnQub25tb3VzZW1vdmUgPSBmdW5jdGlvbiggZXZlbnQgKSB7XG5cdFx0XHRcdHZhciBkZWdyZWUgPSBDbGlja0dhbWUuZ2V0QW5nbGUoZXZlbnQsIHRydWUpO1xuXHRcdFx0XHR1c2VyQ29udHJvbGxlZC5jYW5ub25zW2dhbWVPYmplY3QuY3VycmVudENhbm5vbl0ub2JqLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSggJyArIGRlZ3JlZSArICdkZWcpJztcblx0XHRcdFx0dXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLm9iai5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlWSgtNTAlKSByb3RhdGUoICcgKyBkZWdyZWUgKyAnZGVnKSc7XG5cdFx0XHR9XG5cblx0XHRcdENsaWNrR2FtZS5GaWdodGVySW5pdCgpO1xuXHR9LFxuXG4vLyBMQVNFUiBDT0RFIFNUQVJUUyBIRVJFXG5cdGxhc2VySW5pdDogZnVuY3Rpb24oIGV2ZW50ICkgeyBcblx0XHQvLyBTZXR0aW5nIHVwIGxhemVyIHN0YXJ0IHBvaW50IGFuZCBhbmdsZVxuXHRcdHZhciBsYXNlclZhbHVlcyBcdFx0PSB7J3Nsb3BlJyA6IDAsICd5SW50ZXJjZXB0JyA6IDAsICd4SW5jcmVtZW50b3InIDogMCwgJ2xhc2VyTnVtJyA6IC0xLCAnb2JqJzogbnVsbCwgc2lkZTogJ2xlZnQnfTsgXG4gICAgXHR2YXIgdGllRmlnaHRlck5vaXNlIFx0PSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGllLWZpZ2h0ZXItYXVkaW8nKTtcbiAgICBcdGxhc2VyVmFsdWVzLnNpZGUgXHRcdD0gdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLnNpZGU7XG4gICAgXHR2YXIgaGVpZ2h0IFx0XHRcdFx0PSB1c2VyQ29udHJvbGxlZC5jYW5ub25zW2dhbWVPYmplY3QuY3VycmVudENhbm5vbl0ub2JqLmNsaWVudEhlaWdodDtcbiAgICBcdHZhciB4IFx0XHRcdFx0XHQ9IGxhc2VyVmFsdWVzLnNpZGUgIT0gJ3JpZ2h0JyA/IDAgOiBnYW1lT2JqZWN0LnBvc2l0aW9uLndpZHRoO1xuICAgIFx0dmFyIHkgXHRcdFx0XHRcdD0gZ2FtZU9iamVjdC5zY3JlZW5IZWlnaHQgLSAodXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLnBvc2l0aW9uLmJvdHRvbSAtIChoZWlnaHQvMikpOyBcbiAgICBcdHZhciBtb3VzZVggXHRcdFx0XHQ9IGV2ZW50LmNsaWVudFggLSBnYW1lT2JqZWN0LnBvc2l0aW9uLmxlZnQ7IFxuXHRcdHZhciBtb3VzZVkgXHRcdFx0XHQ9IE1hdGguYWJzKGV2ZW50LmNsaWVudFkgLSBnYW1lT2JqZWN0LnNjcmVlbkhlaWdodCk7XG5cdFx0bGFzZXJWYWx1ZXMub2JqXHRcdFx0PSBDbGlja0dhbWUuY3JlYXRlTGFzZXIoZXZlbnQsIHgpO1x0XG5cbiAgICBcdGxhc2VyVmFsdWVzLnNsb3BlIFx0XHQ9IENsaWNrR2FtZS5nZXRTbG9wZShtb3VzZVgsIG1vdXNlWSk7IFxuXG5cblxuICAgIFx0bGFzZXJWYWx1ZXMueEluY3JlbWVudG9yID0gZ2FtZU9iamVjdC5sYXNlcldpZHRoO1xuICAgIFx0bGFzZXJWYWx1ZXMueUludGVyY2VwdCA9IHBhcnNlSW50KGxhc2VyVmFsdWVzLm9iai5zdHlsZS5ib3R0b20ucmVwbGFjZSgncHgnLCAnJykpO1xuXG4gICAgXHRsYXNlclZhbHVlcy5sYXNlck51bSA9IGdhbWVPYmplY3QubGFzZXJDb3VudGVyO1xuXG4gICAgXHRDbGlja0dhbWUudXBkYXRlTGFzZXIobGFzZXJWYWx1ZXMsIDAgKTtcblxuICAgIFx0Z2FtZU9iamVjdC5sYXNlckNvdW50ZXIgKz0gMTsgXG4gICAgXHQvLyB0aWVGaWdodGVyTm9pc2Uuc2V0QXR0cmlidXRlKCdzcmMnLCAnaHR0cDovL3d3dy5zYS1tYXRyYS5uZXQvc291bmRzL3N0YXJ3YXJzL1RJRS1GaXJlLndhdicpO1xuICAgIFx0Ly8gdGllRmlnaHRlck5vaXNlLnBsYXkoKTtcblx0fSxcblxuXHQvL0NyZWF0ZXMgYSBsYXNlciBiYXNlZCBvbiB3aGVyZSB0aGUgY2Fubm9uIGlzIGN1cnJlbnRseSBwb2ludGluZy5cblx0Y3JlYXRlTGFzZXI6IGZ1bmN0aW9uKCBldmVudCwgeCApIHtcblx0XHR2YXIgbGFzZXIgXHRcdD0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0dmFyIGxhc2VyVG9wIFx0PSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR2YXIgbGFzZXJCb3R0b20gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHR2YXIgZGVncmVlIFx0XHQ9IENsaWNrR2FtZS5nZXRBbmdsZShldmVudCwgZmFsc2UpO1xuXHRcdHZhciBzaWRlIFx0XHQ9IHVzZXJDb250cm9sbGVkLmNhbm5vbnNbZ2FtZU9iamVjdC5jdXJyZW50Q2Fubm9uXS5zaWRlO1xuXG5cblx0XHRsYXNlclRvcC5jbGFzc05hbWUgPSAnbGFzZXItdG9wIGxhc2VyLWdlbmVyYWwnO1xuXHRcdGxhc2VyQm90dG9tLmNsYXNzTmFtZSA9ICdsYXNlci1ib3R0b20gbGFzZXItZ2VuZXJhbCc7XG5cblx0XHRsYXNlci5hcHBlbmRDaGlsZChsYXNlclRvcCk7XG5cdFx0bGFzZXIuYXBwZW5kQ2hpbGQobGFzZXJCb3R0b20pO1xuXHRcdFxuXHRcdGlmICggc2lkZSAhPT0gJ3JpZ2h0JyApIHtcblx0XHRcdGxhc2VyLmNsYXNzTmFtZSBcdFx0PSAnbGFzZXItY29udGFpbmVyIGxhc2VyLWNvbnRhaW5lci1sZWZ0IHB1c2gtbGFzZXItbGVmdCBsYXNlck51bS0nICsgZ2FtZU9iamVjdC5sYXNlckNvdW50ZXI7IFxuXHRcdFx0bGFzZXJUb3AuY2xhc3NOYW1lIFx0XHQ9ICdsYXNlci10b3AgcHVzaC1sYXNlci1yaWdodCBsYXNlci1nZW5lcmFsJztcblx0XHRcdGxhc2VyQm90dG9tLmNsYXNzTmFtZSBcdD0gJ2xhc2VyLWJvdHRvbSBwdXNoLWxhc2VyLXJpZ2h0IGxhc2VyLWdlbmVyYWwnO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRsYXNlci5jbGFzc05hbWUgPSAnbGFzZXItY29udGFpbmVyIGxhc2VyLWNvbnRhaW5lci1yaWdodCBwdXNoLWxhc2VyLXJpZ2h0IGxhc2VyTnVtLScgKyBnYW1lT2JqZWN0Lmxhc2VyQ291bnRlcjsgXG5cdFx0XHRsYXNlclRvcC5jbGFzc05hbWUgXHRcdD0gJ2xhc2VyLXRvcCBwdXNoLWxhc2VyLWxlZnQgbGFzZXItZ2VuZXJhbCc7XG5cdFx0XHRsYXNlckJvdHRvbS5jbGFzc05hbWUgXHQ9ICdsYXNlci1ib3R0b20gcHVzaC1sYXNlci1sZWZ0IGxhc2VyLWdlbmVyYWwnO1xuXHRcdH1cblxuXHRcdGlmKCBzaWRlICE9ICdyaWdodCcgKSB7XG5cdFx0XHRsYXNlci5zdHlsZS5sZWZ0ID0gMCArICdweCc7XHRcblx0XHR9IGVsc2Uge1xuXHRcdFx0bGFzZXIuc3R5bGUucmlnaHQgPSAwICsgJ3B4Jztcblx0XHR9XHRcblx0XHRcblx0XHRsYXNlci5zdHlsZS50cmFuc2Zvcm0gXHRcdD0gJ3RyYW5zbGF0ZVkoLTUwJSkgcm90YXRlKCAnICsgZGVncmVlICsgJ2RlZyknO1xuXHRcdGxhc2VyLnN0eWxlLndlYmtpdFRyYW5zZm9ybSA9ICd0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSggJyArIGRlZ3JlZSArICdkZWcpJztcblxuXHRcdFxuXHRcdHZhciBoZWlnaHQgPSB1c2VyQ29udHJvbGxlZC5jYW5ub25zW2dhbWVPYmplY3QuY3VycmVudENhbm5vbl0ucG9zaXRpb24uaGVpZ2h0LzI7XHRcblx0XHR2YXIgYm90dG9tID0gZ2FtZU9iamVjdC5zY3JlZW5IZWlnaHQgLSAodXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLnBvc2l0aW9uLmJvdHRvbSArIGhlaWdodCk7XG5cblx0XHRsYXNlci5zdHlsZS5ib3R0b20gPSBib3R0b20gKyAncHgnO1xuXG5cdFx0Z2FtZU9iamVjdC5jb250YWluZXIuYXBwZW5kQ2hpbGQoIGxhc2VyICk7IFxuXG5cdFx0cmV0dXJuIGxhc2VyO1xuXHR9LFxuXG5cdHVwZGF0ZUxhc2VyOiBmdW5jdGlvbiggbGFzZXJWYWx1ZXMsIHggKSB7XG5cdFx0Z2FtZU9iamVjdC5sYXNlclRpbWVyc1tsYXNlclZhbHVlcy5sYXNlck51bV0gPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpeyBcblxuXHRcdFx0dmFyIHNpZGUgXHRcdFx0PSBsYXNlclZhbHVlcy5zaWRlO1xuXHRcdFx0dmFyIG5ld1ggXHRcdFx0PSB4ICsgbGFzZXJWYWx1ZXMueEluY3JlbWVudG9yOyBcblx0XHRcdHZhciBteCBcdFx0XHRcdD0gbGFzZXJWYWx1ZXMuc2xvcGUgKiBuZXdYO1xuXHRcdFx0bXggXHRcdFx0XHRcdD0gc2lkZSAhPSAncmlnaHQnID8gbXggOiAtbXg7XG5cdFx0XHR2YXIgbmV3WSBcdFx0XHQ9ICBteCArIGxhc2VyVmFsdWVzLnlJbnRlcmNlcHQ7XG5cdFx0XHQvLyB2YXIgYm90dG9tID0gIE1hdGguYWJzKG5ld1kgLSBnYW1lT2JqZWN0LnNjcmVlbkhlaWdodCk7XG5cblx0XHRcdGxhc2VyVmFsdWVzLm9iai5zdHlsZS5ib3R0b20gXHQ9IG5ld1kgKyAncHgnOyBcblxuXHRcdGlmKCBzaWRlICE9ICdyaWdodCcgKSB7IFxuXHRcdFx0bGFzZXJWYWx1ZXMub2JqLnN0eWxlLmxlZnQgPSBuZXdYICsgJ3B4JztcdFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRsYXNlclZhbHVlcy5vYmouc3R5bGUucmlnaHQgPSAgbmV3WCArICdweCc7XG5cdFx0fVxuXHRcdFx0XG5cdFx0XHR2YXIgaGl0Qm94ID0gQ2xpY2tHYW1lLmhhc0hpdChsYXNlclZhbHVlcy5vYmopO1xuXG5cdFx0XHRpZiggKG5ld1ggPj0gMCAmJiBuZXdYIDwgZ2FtZU9iamVjdC5jb250YWluZXJXaWR0aCkgJiYgKG5ld1kgPj0gMCAmJiBuZXdZIDwgZ2FtZU9iamVjdC5jb250YWluZXJIZWlnaHQpICYmICFoaXRCb3ggKSB7XG5cdFx0XHRcdENsaWNrR2FtZS51cGRhdGVMYXNlciggbGFzZXJWYWx1ZXMsIG5ld1ggKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGxhc2VyVmFsdWVzLm9iai5yZW1vdmUoKTtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KGdhbWVPYmplY3QubGFzZXJUaW1lcnNbbGFzZXJWYWx1ZXMubGFzZXJOdW1dKVxuXHRcdFx0fVxuXHRcdH0sIDUpOyBcblxuXHR9LFxuLy8gTEFTRVIgQ09ERSBFTkRTIEhFUkVcblxuLy8gRklHSFRFUiBDT0RFIFNUQVJUUyBIRVJFXG5cdEZpZ2h0ZXJJbml0OiBmdW5jdGlvbigpIHtcblx0XHR2YXIgY3VycmVudEZpZ2h0ZXJzID0gW107XG5cdFx0dmFyIG51bUZpZ2h0ZXJzID0gMztcblx0XHR2YXIgYXR0YWNrZXJTZXQgPSBmYWxzZTtcblx0XHR2YXIgcmFuZG9tTnVtYmVyID0gKE1hdGguY2VpbChNYXRoLnJhbmRvbSgpICogMTApID4gNSkgPyAwIDogMjtcblx0XHRcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG51bUZpZ2h0ZXJzOyBpKyspIHtcblx0XHRcdHZhciBmaWdodGVyID0gQ2xpY2tHYW1lLmNyZWF0ZUZpZ2h0ZXJzKG51bUZpZ2h0ZXJzLCBpKTtcblx0XHRcdGlmICggaSUyID09IDAgJiYgIWF0dGFja2VyU2V0ICYmIGkgPT0gcmFuZG9tTnVtYmVyICkge1xuXHRcdFx0XHRmaWdodGVyLmlzQXR0YWNrZXIgPSB0cnVlO1xuXHRcdFx0XHRhdHRhY2tlclNldCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRnYW1lT2JqZWN0LmZpZ2h0ZXJzLnB1c2goZmlnaHRlcik7XG5cdFx0XHRjdXJyZW50RmlnaHRlcnMucHVzaChmaWdodGVyKTtcblx0XHRcdGdhbWVPYmplY3QuZmlnaHRlckNvdW50ZXIrKztcblx0XHR9XG5cblx0XHRbXS5mb3JFYWNoLmNhbGwoY3VycmVudEZpZ2h0ZXJzLCBmdW5jdGlvbihmaWdodGVyKSB7XHRcdFx0XG5cdFx0XHRDbGlja0dhbWUudXBkYXRlRmlnaHRlcihmaWdodGVyKTtcblx0XHR9KTtcblxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XHRcblx0XHRcdENsaWNrR2FtZS5GaWdodGVySW5pdCgpO1xuXHRcdH0sIDEwMDAwKTtcblx0fSxcblxuXHRjcmVhdGVGaWdodGVyczogZnVuY3Rpb24obnVtRmlnaHRlcnMsIG51bWJlcikge1xuXHRcdHZhciBmaWdodGVyID0geyd5JzogMCwgJ3lJbmNyZW1lbnRvcic6IDEwLCAneCc6IDAsICd4SW5jcmVtZW50b3InOiAxMCwgJ3RvdGFsSFAnOiAzLCAnaGl0UG9pbnRzJzogMywgJ2ZpZ2h0ZXJOdW0nOiBnYW1lT2JqZWN0LmZpZ2h0ZXJDb3VudGVyLCAnaHBCYXInOiBudWxsLCAnY29udGFpbmVyJzogbnVsbCwgJ29iaic6IG51bGwsICdwb3NpdGlvbic6IC0xLCAnaXNBdHRhY2tlcic6IGZhbHNlfTtcblx0XHRmaWdodGVyLm9iaiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdGZpZ2h0ZXIuaHBCYXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRmaWdodGVyLmNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXHRcdGZpZ2h0ZXIuaHBCYXIuY2xhc3NOYW1lID0gJ2ZpZ2h0ZXItaGl0LXBvaW50cyc7XG5cdFx0ZmlnaHRlci5ocEJhci5zdHlsZS53aWR0aCA9ICczMHB4Jztcblx0XHRmaWdodGVyLm9iai5jbGFzc05hbWUgPSAnZmlnaHRlcnMgZmlnaHRlcisnICsgZ2FtZU9iamVjdC5maWdodGVyQ291bnRlciArICcrJztcblx0XHRmaWdodGVyLmNvbnRhaW5lci5hcHBlbmRDaGlsZChmaWdodGVyLm9iaik7XG5cdFx0ZmlnaHRlci5jb250YWluZXIuYXBwZW5kQ2hpbGQoZmlnaHRlci5ocEJhcik7XG5cdFx0ZmlnaHRlci5jb250YWluZXIuY2xhc3NOYW1lID0gJ2ZpZ2h0ZXItY29udGFpbmVycyc7XG5cdFx0ZmlnaHRlci5wb3NpdGlvbiA9IG51bWJlcjtcblx0XHRmaWdodGVyLmlzQXR0YWNrZXIgPSBmYWxzZTtcblxuXHRcdGlmKCBudW1GaWdodGVycyA9PSAyICkge1xuXHRcdFx0c3dpdGNoKG51bWJlcikge1xuXHRcdFx0ICBjYXNlIDA6XG5cdFx0XHQgICAgZmlnaHRlci54ID0gKGdhbWVPYmplY3Quc2NyZWVuV2lkdGgvMiAtIDE1KSAtIDMwO1xuXHRcdFx0ICAgIGZpZ2h0ZXIueSA9IC02MDtcblx0XHRcdCAgICBicmVhaztcblx0XHRcdCAgY2FzZSAxOlxuXHRcdFx0ICAgIGZpZ2h0ZXIueCA9IChnYW1lT2JqZWN0LnNjcmVlbldpZHRoLzIgLSAxNSkgKyAzMDtcblx0XHRcdCAgICBmaWdodGVyLnkgPSAtNjA7XG5cdFx0XHQgICAgYnJlYWs7XG5cdFx0XHR9IFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRzd2l0Y2gobnVtYmVyKSB7XG5cdFx0XHQgIGNhc2UgMDpcblx0XHRcdCAgICBmaWdodGVyLnggPSAoZ2FtZU9iamVjdC5zY3JlZW5XaWR0aC8yIC0gMTUpIC0gNTU7XG5cdFx0XHQgICAgZmlnaHRlci55ID0gLTcwO1xuXHRcdFx0ICAgIGJyZWFrO1xuXHRcdFx0ICBjYXNlIDE6XG5cdFx0XHQgICAgZmlnaHRlci54ID0gKGdhbWVPYmplY3Quc2NyZWVuV2lkdGgvMiAtIDE1KTtcblx0XHRcdCAgICBmaWdodGVyLnkgPSAtNjA7XG5cdFx0XHQgICAgYnJlYWs7XG5cdFx0XHQgIGNhc2UgMjpcblx0XHRcdCAgXHRmaWdodGVyLnggPSAoZ2FtZU9iamVjdC5zY3JlZW5XaWR0aC8yIC0gMTUpICsgNTU7XG5cdFx0XHQgIFx0ZmlnaHRlci55ID0gLTcwO1xuXHRcdFx0ICBcdGJyZWFrO1xuXHRcdFx0fSBcblx0XHR9XG5cblx0XHRmaWdodGVyLmNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gZmlnaHRlci54ICsgJ3B4Jztcblx0XHRmaWdodGVyLmNvbnRhaW5lci5zdHlsZS50b3AgPSBmaWdodGVyLnkgKyAncHgnO1xuXHRcdGdhbWVPYmplY3QuY29udGFpbmVyLmFwcGVuZENoaWxkKGZpZ2h0ZXIuY29udGFpbmVyKTtcblx0XHRyZXR1cm4gZmlnaHRlcjtcblx0fSxcblxuXHR1cGRhdGVGaWdodGVyOiBmdW5jdGlvbihmaWdodGVyLCBjaG9zZW5GaWdodGVyKSB7XG5cdFx0Z2FtZU9iamVjdC5maWdodGVyVGltZXJzW2ZpZ2h0ZXIuZmlnaHRlck51bV0gPSBzZXRUaW1lb3V0KCBmdW5jdGlvbigpe1xuXHRcdFx0ZmlnaHRlci55ICs9IGZpZ2h0ZXIueUluY3JlbWVudG9yO1xuXHRcdFx0ZmlnaHRlci5jb250YWluZXIuc3R5bGUudG9wID0gZmlnaHRlci55ICsgJ3B4Jztcblx0XHRcdHZhciByZWdleCA9IC9cXCsoLiopXFwrLztcblx0XHRcdHZhciBmaWdodGVyTnVtID0gZmlnaHRlci5vYmouY2xhc3NOYW1lLm1hdGNoKHJlZ2V4KVsxXTtcblx0XHRcdHZhciB0b3BPckJvdHRvbVR1cnJldCA9IChNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIDEwKSA+IDUpID8gJ3RvcCcgOiAnYm90dG9tJztcblx0XHRcdHZhciB0dXJyZXQ7IFxuXHRcdFx0XG5cdFx0XHRpZiAoZmlnaHRlci5pc0F0dGFja2VyKSB7XG5cdFx0XHRcdGlmKGZpZ2h0ZXIucG9zaXRpb24gPT0gMCkge1xuXHRcdFx0XHRcdHR1cnJldCA9IHRvcE9yQm90dG9tVHVycmV0ICsgJ2xlZnQnO1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCd0dXJyZXQgbGVmdCcpO1xuXHRcdFx0XHRcdGZpZ2h0ZXIueCA9IGZpZ2h0ZXIueCAtIDE7XG5cdFx0XHRcdFx0ZmlnaHRlci5jb250YWluZXIuc3R5bGUubGVmdCA9IGZpZ2h0ZXIueCArICdweCc7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0dHVycmV0ID0gdG9wT3JCb3R0b21UdXJyZXQgKyAncmlnaHQnO1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCd0dXJyZXQgcmlnaHQnKTtcblx0XHRcdFx0XHRmaWdodGVyLnggKz0gMTtcblx0XHRcdFx0XHRmaWdodGVyLmNvbnRhaW5lci5zdHlsZS5sZWZ0ID0gZmlnaHRlci54ICsgJ3B4Jztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAoZmlnaHRlci55IDw9IGdhbWVPYmplY3Quc2NyZWVuSGVpZ2h0KSB7XG5cdFx0XHRcdENsaWNrR2FtZS51cGRhdGVGaWdodGVyKGZpZ2h0ZXIpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y2xlYXJUaW1lb3V0KGdhbWVPYmplY3QuZmlnaHRlclRpbWVyc1tmaWdodGVyLmZpZ2hlck51bV0pO1xuXHRcdFx0XHRmaWdodGVyLmNvbnRhaW5lci5yZW1vdmUoKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gfVxuXHRcdH0sIDEwMCk7XG5cdH0sXG4vLyBGSUdIVEVSIENPREUgRU5EUyBIRVJFXG5cblxuXHRnZXRBbmdsZTogZnVuY3Rpb24oIGV2ZW50ICkge1xuXHRcdHZhciBzaWRlID0gdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLnNpZGU7XG5cdFx0dmFyIHBvc2l0aW9uID0gdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLnBvc2l0aW9uO1xuXG5cdFx0dmFyIG1vdXNlWCA9IGV2ZW50LmNsaWVudFggLSBnYW1lT2JqZWN0LnBvc2l0aW9uLmxlZnQ7XG5cdFx0dmFyIG1vdXNlWSA9IE1hdGguYWJzKGV2ZW50LmNsaWVudFkgLSBnYW1lT2JqZWN0LnNjcmVlbkhlaWdodCk7XG5cdFx0dmFyIGNhbm5vblkgPSBnYW1lT2JqZWN0LnNjcmVlbkhlaWdodCAtICggcG9zaXRpb24uYm90dG9tIC0gKGdhbWVPYmplY3QuY2Fubm9uSGVpZ2h0IC8gMikgKTtcblx0XHR2YXIgY2Fubm9uWCA9IHNpZGUgPT0gJ3JpZ2h0JyA/IHBvc2l0aW9uLnJpZ2h0IDogcG9zaXRpb24ubGVmdDtcblx0XHRcblx0XHR2YXIgd2FsbCA9IHsgJ3gnOiAoc2lkZSA9PSAncmlnaHQnID8gZ2FtZU9iamVjdC5zY3JlZW5XaWR0aCA6IDApLCAneSc6IG1vdXNlWX07XG5cdFx0dmFyIG1vdXNlID0geyAneCc6IG1vdXNlWCwgJ3knOiBtb3VzZVl9OyBcblx0XHR2YXIgY2Fubm9uID0geyAneCc6IGNhbm5vblgsICd5JzogY2Fubm9uWX07XG5cblx0XHR2YXIgb3Bwb3NpdGUgPSBNYXRoLmFicyhtb3VzZS54IC0gd2FsbC54KTtcblx0XHR2YXIgYWRqYWNlbnQgPSBNYXRoLmFicyhjYW5ub24ueSAtIHdhbGwueSk7IFxuXHRcdHZhciB0YW4gPSBvcHBvc2l0ZS9hZGphY2VudDtcblx0XHR2YXIgZGVncmVlID0gTWF0aC5hdGFuKHRhbikgKiAxODAgLyBNYXRoLlBJOyBcblxuXHRcdGRlZ3JlZSA9IDkwIC0gZGVncmVlO1xuXG5cdFx0aWYgKHNpZGUgPT0gJ3JpZ2h0JykgeyBcblx0XHRcdGlmIChtb3VzZS55IDwgY2Fubm9uLnkpIHsgXG5cdFx0XHRcdGRlZ3JlZSA9IC1kZWdyZWU7XG5cdFx0XHR9IFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAobW91c2UueSA+IGNhbm5vbi55KSB7XG5cdFx0XHRcdGRlZ3JlZSA9IC1kZWdyZWU7XG5cdFx0XHR9IFxuXHRcdH1cblxuXHRcdHJldHVybiBkZWdyZWU7XHRcblx0fSxcblxuXHRoYXNIaXQ6IGZ1bmN0aW9uKGxhc2VyKSB7XG5cdFx0dmFyIGZpZ2h0ZXJzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnZmlnaHRlcnMnKTtcblx0XHR2YXIgaGl0ID0gZmFsc2U7XG5cdFx0W10uZm9yRWFjaC5jYWxsKGZpZ2h0ZXJzLCBmdW5jdGlvbihmaWdodGVyKSB7XG5cdFx0XHR2YXIgcG9zaXRpb24gXHRcdD0gZmlnaHRlci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblx0XHRcdHZhciB0aGVMYXNlclx0XHQ9IGxhc2VyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXHRcdFx0dmFyIHJlZ2V4ID0gL1xcKyguKilcXCsvO1xuXHRcdFx0dmFyIGZpZ2h0ZXJOdW0gPSBmaWdodGVyLmNsYXNzTmFtZS5tYXRjaChyZWdleClbMV07IFxuXHRcdFx0dmFyIGN1cnJlbnRGaWdodGVyID0gZ2FtZU9iamVjdC5maWdodGVyc1tmaWdodGVyTnVtXTtcblx0XHRcdGlmICggKCh0aGVMYXNlci50b3AgPiBwb3NpdGlvbi50b3AgJiYgdGhlTGFzZXIudG9wIDwgcG9zaXRpb24uYm90dG9tKSB8fCAodGhlTGFzZXIuYm90dG9tID4gcG9zaXRpb24udG9wICYmIHRoZUxhc2VyLmJvdHRvbSA8IHBvc2l0aW9uLmJvdHRvbSkpIFxuXHRcdFx0XHQmJiAoKHRoZUxhc2VyLnJpZ2h0IDwgcG9zaXRpb24ucmlnaHQgJiYgdGhlTGFzZXIucmlnaHQgPiBwb3NpdGlvbi5sZWZ0KSB8fCAodGhlTGFzZXIubGVmdCA8IHBvc2l0aW9uLnJpZ2h0ICYmIHRoZUxhc2VyLmxlZnQgPiBwb3NpdGlvbi5sZWZ0KSkgKSB7XG5cdFx0XHRcdGN1cnJlbnRGaWdodGVyLmhpdFBvaW50cyA9IGN1cnJlbnRGaWdodGVyLmhpdFBvaW50cyAtIDE7XG5cdFx0XHRcdHZhciBuZXdIUCA9IGN1cnJlbnRGaWdodGVyLmhwQmFyLnN0eWxlLndpZHRoLnJlcGxhY2UoJ3B4JywgJycpICogKGN1cnJlbnRGaWdodGVyLmhpdFBvaW50cy9jdXJyZW50RmlnaHRlci50b3RhbEhQKTsgXG5cdFx0XHRcdGN1cnJlbnRGaWdodGVyLmhwQmFyLnN0eWxlLndpZHRoID0gbmV3SFAgKyAncHgnO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGN1cnJlbnRGaWdodGVyLmhpdFBvaW50cyA9PSAwKSB7XG5cdFx0XHRcdFx0ZmlnaHRlci5wYXJlbnROb2RlLnJlbW92ZSgpO1x0XG5cdFx0XHRcdH1cblx0XHRcdFx0aGl0ID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRyZXR1cm4gaGl0O1xuXHR9LFxuXG5cdGtleXByZXNzOiBmdW5jdGlvbihldmVudCkge1xuXHRcdHN3aXRjaChldmVudC5rZXlDb2RlKSB7XG5cdFx0XHRjYXNlIDQ5OlxuXHRcdFx0XHRnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub24gPSAndG9wTGVmdCc7IFxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgNTA6XG5cdFx0XHRcdGdhbWVPYmplY3QuY3VycmVudENhbm5vbiA9ICdib3R0b21MZWZ0JzsgXG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSA1MTpcblx0XHRcdFx0Z2FtZU9iamVjdC5jdXJyZW50Q2Fubm9uID0gJ3RvcFJpZ2h0JzsgXG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSA1Mjpcblx0XHRcdFx0Z2FtZU9iamVjdC5jdXJyZW50Q2Fubm9uID0gJ2JvdHRvbVJpZ2h0JzsgXG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fSxcblxuXG5cdGdldFNsb3BlOiBmdW5jdGlvbiggWDEsIFkxKSB7XG5cdFx0cmV0dXJuICggWTEgLSB1c2VyQ29udHJvbGxlZC5jYW5ub25zW2dhbWVPYmplY3QuY3VycmVudENhbm5vbl0uY2VudGVyUG9pbnRbMV0gKSAvICggWDEgLSB1c2VyQ29udHJvbGxlZC5jYW5ub25zW2dhbWVPYmplY3QuY3VycmVudENhbm5vbl0uY2VudGVyUG9pbnRbMF0gKTtcblx0fSxcblxuXG5cdGxpbmVMZW5ndGg6IGZ1bmN0aW9uICggWCwgWSApIHtcblx0XHR2YXIgeDsgXG5cdFx0dmFyIHhDYWxjID0gTWF0aC5wb3coICggdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLmNlbnRlclBvaW50WzBdIC0gWCApLCAgMik7XG5cdFx0dmFyIHlDYWxjID0gTWF0aC5wb3coICggdXNlckNvbnRyb2xsZWQuY2Fubm9uc1tnYW1lT2JqZWN0LmN1cnJlbnRDYW5ub25dLmNlbnRlclBvaW50WzBdIC0gWSApLCAyKTtcblx0XHRcblx0XHRyZXR1cm4gTWF0aC5zcXJ0KCAoeENhbGMgKyB5Q2FsYykgKTtcblx0fVxuXG59XG5cblxudmFyIGdhbWVPYmplY3QgPSBuZXcgT2JqZWN0KCk7XG52YXIgdXNlckNvbnRyb2xsZWQgPSBuZXcgT2JqZWN0KCk7XG53aW5kb3cub25sb2FkID0gQ2xpY2tHYW1lLmluaXQoKTsiXX0=
